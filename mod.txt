# pipeline_runner.py
import argparse
from kfp.v2 import compiler
from kfp.v2.google.client import AIPlatformClient
from pipeline_definition import fraud_pipeline

def parse_args():
    parser = argparse.ArgumentParser()
    parser.add_argument('--data_path', required=True)
    parser.add_argument('--job_date', required=True)
    return parser.parse_args()

def main():
    args = parse_args()

    compiler.Compiler().compile(
        pipeline_func=fraud_pipeline,
        package_path='fraud_pipeline.json'
    )

    client = AIPlatformClient(
        project='your-gcp-project',
        region='us-central1'
    )

    client.create_run_from_job_spec(
        job_spec_path='fraud_pipeline.json',
        pipeline_root='gs://your-bucket/pipeline-root',
        parameter_values={
            "data_path": args.data_path,
            "job_date": args.job_date,
        }
    )

if __name__ == '__main__':
    main()
